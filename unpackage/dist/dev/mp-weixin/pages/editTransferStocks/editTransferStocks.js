(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/editTransferStocks/editTransferStocks"],{728:function(e,t,a){"use strict";(function(e,t){var s=a(4);a(26);s(a(25));var r=s(a(729));e.__webpack_require_UNI_MP_PLUGIN__=a,t(r.default)}).call(this,a(1)["default"],a(2)["createPage"])},729:function(e,t,a){"use strict";a.r(t);var s=a(730),r=a(732);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a(734);var i,o=a(36),u=Object(o["default"])(r["default"],s["render"],s["staticRenderFns"],!1,null,"98a2d5f4",null,!1,s["components"],i);u.options.__file="pages/editTransferStocks/editTransferStocks.vue",t["default"]=u.exports},730:function(e,t,a){"use strict";a.r(t);var s=a(731);a.d(t,"render",(function(){return s["render"]})),a.d(t,"staticRenderFns",(function(){return s["staticRenderFns"]})),a.d(t,"recyclableRender",(function(){return s["recyclableRender"]})),a.d(t,"components",(function(){return s["components"]}))},731:function(e,t,a){"use strict";var s;a.r(t),a.d(t,"render",(function(){return r})),a.d(t,"staticRenderFns",(function(){return i})),a.d(t,"recyclableRender",(function(){return n})),a.d(t,"components",(function(){return s}));try{s={uniForms:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(a.bind(null,1116))},uniFormsItem:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item")]).then(a.bind(null,1129))},uniPopup:function(){return a.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(a.bind(null,1075))}}}catch(o){if(-1===o.message.indexOf("Cannot find module")||-1===o.message.indexOf(".vue"))throw o;console.error(o.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,t=e.$createElement,a=(e._self._c,e.params.transferDetailList.length),s=e.productList&&e.productList.length>0;e.$mp.data=Object.assign({},{$root:{g0:a,g1:s}})},n=!1,i=[];r._withStripped=!0},732:function(e,t,a){"use strict";a.r(t);var s=a(733),r=a.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);t["default"]=r.a},733:function(e,t,a){"use strict";(function(e){var s=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(a(53)),n=s(a(55)),i=a(57),o=(a(473),a(25),function(){a.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(function(){return resolve(a(1075))}.bind(null,a)).catch(a.oe)}),u={components:{uniPopup:o},data:function(){return{indicatorStyle:"height: 50px;",store:"",outWarehouseDelId:"",outWarehouseName:"",inWarehouseName:"",orderType:"",paymentTerms:"",agentUser:"",value:[0],selectList:[],selectList1:[],selectIndex:0,openIndex:null,product:[{},{}],productList:[],searchValue:"",params:{pageNum:1,pageSize:20,transferDetailList:[{}]},index:"",params1:{pageNum:1,pageSize:20},params2:{pageNum:1,pageSize:20},params3:{pageNum:1,pageSize:20},item:{},array:["移库","调拨"],selectList2:[],inventoryId:"",warehouseId:"",classification:"",title:"",index1:"",aa:!1,Number:0,rules:{quantity:{rules:[{required:!0,errorMessage:"请输入正确数量"},{pattern:/^[1-9]\d*$/,errorMessage:"请输入大于零的整数"}]},position:{rules:[{required:!0,errorMessage:'请输入新库位"'}]}},showMask:!1}},onLoad:function(e){var t=this;return(0,n.default)(r.default.mark((function a(){var s;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,i.detailTransferStocks)(e.id);case 2:s=a.sent,t.params=s.data,t.warehouseId=s.data.outWarehouseId,t.params.warehouseId=s.data.outWarehouseId,t.outWarehouseName=t.params.outWarehouseName,t.inWarehouseName=t.params.inWarehouseName,t.agentUser=t.params.agentUser,1==t.params.orderType?t.orderType="移库":t.orderType="调拨";case 10:case"end":return a.stop()}}),a)})))()},onBackPress:function(e){if("navigateBack"==e.from){var t=getCurrentPages(),a=t[t.length-2];a=a.$vm,a&&a.getList&&a.getList(1,a.list.length+1)}},methods:{bindTextAreaBlur:function(e){this.params.remark=e.detail.value},a:function(e){this.index1=e},bindTextAreaBlur1:function(e){this.params.transferDetailList[this.index1].remark=e.detail.value},open:function(t){var a=this;return(0,n.default)(r.default.mark((function s(){var n,o,u,c;return r.default.wrap((function(s){while(1)switch(s.prev=s.next){case 0:a.selectIndex=0,a.selectList=[],a.selectList1=[],a.selectList2=[],s.t0=t,s.next=0===s.t0?7:1===s.t0?13:2===s.t0?19:3===s.t0?25:4===s.t0?28:34;break;case 7:return a.title="请选择移出门店",s.next=10,(0,i.getwarehouse)(a.params3);case 10:return n=s.sent,n.data.items?n.data.items.forEach((function(e){a.selectList.push(e.warehouseName),a.selectList1.push(e.warehouseId),a.selectList2.push(e.warehouseCode)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),s.abrupt("break",34);case 13:return a.title="请选择移入门店",s.next=16,(0,i.getwarehouse)(a.params3);case 16:return o=s.sent,o.data.items?o.data.items.forEach((function(e){a.selectList.push(e.warehouseName),a.selectList1.push(e.warehouseId),a.selectList2.push(e.warehouseCode)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),s.abrupt("break",34);case 19:return a.title="请选择经办人",s.next=22,(0,i.getwen)(a.params3);case 22:return u=s.sent,u.rows?u.rows.forEach((function(e){a.selectList.push(e.userName),a.selectList1.push(e.userId)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),s.abrupt("break",34);case 25:return a.title="请选择单据类型",a.selectList=a.array,s.abrupt("break",34);case 28:return a.title="请选择分类",s.next=31,getclassification(a.params3);case 31:return c=s.sent,c.data?c.data.forEach((function(e){a.selectList.push(e.dictLabel)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),s.abrupt("break",34);case 34:a.$refs.popup.open(),a.openIndex=t;case 36:case"end":return s.stop()}}),s)})))()},reset:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var a,s;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.classification="",e.productList=[],a={pageNum:1,pageSize:20},a.warehouseId=e.params2.warehouseId,e.params2={pageNum:1,pageSize:20,warehouseId:a.warehouseId,carg:"",productName:"",pinyin:""},t.next=7,(0,i.getinventory)(a);case 7:s=t.sent,null!=s.data.items&&(e.productList=s.data.items),e.aa=!1;case 10:case"end":return t.stop()}}),t)})))()},scrolltolowerFun:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var a;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params2.pageNum=e.params2.pageNum+1,t.next=3,(0,i.getinventory)(e.params2);case 3:if(a=t.sent,null==a.data.items){t.next=8;break}a.data.items.forEach((function(t){e.productList.push(t)})),t.next=10;break;case 8:return e.aa=!0,t.abrupt("return");case 10:case"end":return t.stop()}}),t)})))()},add:function(){this.params.transferDetailList.push({}),this.Number++},del:function(e){if(this.params.transferDetailList.length>1){var t=this.params.transferDetailList.filter((function(t,a){return a!==e}));this.params.transferDetailList=t}this.Number>0&&this.Number--},clear:function(){this.params.transferDetailList=[{quantity:"",position:"",price:"",oldPosition:""}]},cancel:function(){this.$refs.popup.close()},success:function(){switch(this.openIndex){case 0:this.outWarehouseName=this.selectList[this.selectIndex],this.params.outWarehouseName!=this.outWarehouseName&&this.clear(),this.params.outWarehouseName=this.outWarehouseName,this.params.outWarehouseId=this.selectList1[this.selectIndex],this.params.warehouseId=this.selectList1[this.selectIndex],this.warehouseId=this.selectList1[this.selectIndex],this.params.outWarehouseCode=this.selectList2[this.selectIndex];break;case 1:this.inWarehouseName=this.selectList[this.selectIndex],this.params.inWarehouseName=this.inWarehouseName,this.params.inWarehouseId=this.selectList1[this.selectIndex],this.params.inWarehouseCode=this.selectList2[this.selectIndex];break;case 2:this.agentUser=this.selectList[this.selectIndex],this.params.agentUser=this.agentUser,this.params.agentUid=this.selectList1[this.selectIndex];break;case 3:this.orderType=this.selectList[this.selectIndex],this.params.orderType=this.orderType,"移库"==this.params.orderType?this.params.orderType=1:this.params.orderType=2;break;case 4:this.classification=this.selectList[this.selectIndex],this.params2.classify=this.classification;break}this.$refs.popup.close()},search1:function(){var t=this;return(0,n.default)(r.default.mark((function a(){var s;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.productList=[],a.next=3,(0,i.getinventory)(t.params2);case 3:if(s=a.sent,null==s.data.items){a.next=8;break}t.productList=s.data.items,a.next=10;break;case 8:return e.showToast({title:"没有数据",icon:"none",duration:1e3}),a.abrupt("return");case 10:case"end":return a.stop()}}),a)})))()},Return:function(){var t=this;return(0,n.default)(r.default.mark((function a(){var s;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(void 0!=t.params.inWarehouseName){a.next=4;break}return a.abrupt("return",e.showToast({title:"请选择移入门店",icon:"none",duration:1e3}));case 4:if(void 0!=t.params.agentUser){a.next=8;break}return a.abrupt("return",e.showToast({title:"请选择经办人",icon:"none",duration:1e3}));case 8:if(void 0!=t.params.orderType){a.next=12;break}return a.abrupt("return",e.showToast({title:"请选择单据类型",icon:"none",duration:1e3}));case 12:for(s=0;s<=t.Number;s++)t.$refs.form[s].validate().then(function(){var a=(0,n.default)(r.default.mark((function a(s){var n;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,i.editTransferStocks)(t.params);case 2:n=a.sent,200==n.code&&(e.showToast({title:"修改成功",icon:"none",duration:1e3}),setTimeout((function(){e.navigateBack({data:1})}),1e3));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 13:case"end":return a.stop()}}),a)})))()},bindChange:function(e){this.selectIndex=e.detail.value[0]},openProduct:function(e){var t=this;return(0,n.default)(r.default.mark((function a(){var s;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.inventoryId="",t.index=e,t.params2.pageNum=1,t.params2.pageSize=20,t.params2.warehouseId=t.params.warehouseId,a.next=7,(0,i.getinventory)(t.params2);case 7:s=a.sent,null!=s.data.items&&(t.productList=s.data.items),t.$refs.product.open();case 10:case"end":return a.stop()}}),a)})))()},closeProduct:function(){this.$refs.product.close()},choice:function(e){this.inventoryId=e.inventoryId,this.item=e},join:function(){if(""==this.inventoryId)return e.showToast({title:"请选择产品",icon:"none",duration:1e3});for(var t=0;t<this.params.transferDetailList.length;t++)if(this.params.transferDetailList[t].inventoryId==this.item.inventoryId)return e.showToast({title:"不能添加相同的产品",icon:"none",duration:1e3});this.$set(this.params.transferDetailList[this.index],"inventoryId",this.item.inventoryId),this.$set(this.params.transferDetailList[this.index],"carg",this.item.carg),this.$set(this.params.transferDetailList[this.index],"oldPosition",this.item.positionCode),this.$set(this.params.transferDetailList[this.index],"productName",this.item.productName),this.$set(this.params.transferDetailList[this.index],"productId",this.item.productId),this.$set(this.params.transferDetailList[this.index],"quantity",this.item.usableQuantity),this.$set(this.params.transferDetailList[this.index],"remark",this.item.remark),this.$set(this.params.transferDetailList[this.index],"price",this.item.price),this.$refs.product.close()},chioceView:function(){var t=this,a=e.getSystemInfoSync().platform;"android"==a?(plus.android.checkPermission("android.permission.CAMERA",(function(e){-1==e.checkResult&&(t.showMask=!0)}),(function(e){console.error("Error checking permission:",e.message)})),plus.android.requestPermissions(["android.permission.CAMERA"],(function(e){t.showMask=!1,e.granted.length>0&&t.scanCarg()}))):this.scanCarg()},scanCarg:function(){var t=this;e.scanCode({onlyFromCamera:!0,scanType:["barCode"],success:function(a){var s={carg:a.result,pageNum:1,pageSize:1,warehouseId:t.params.warehouseId};(0,i.getinventory)(s).then((function(a){if(200==a.code)if(a.data.items&&a.data.items.length>0){for(var s=0;s<t.params.transferDetailList.length;s++)if(t.params.transferDetailList[s].productId==a.data.items[0].productId)return e.showToast({title:"不能添加相同的产品",icon:"none",duration:1e3});var r=!0;for(s=0;s<t.params.transferDetailList.length;s++)if(!t.params.transferDetailList[s].productName){t.$set(t.params.transferDetailList[s],"productName",a.data.items[0].productName),t.$set(t.params.transferDetailList[s],"carg",a.data.items[0].carg),t.$set(t.params.transferDetailList[s],"productId",a.data.items[0].productId),t.$set(t.params.transferDetailList[s],"quantity",a.data.items[0].usableQuantity),t.$set(t.params.transferDetailList[s],"inventoryId",a.data.items[0].inventoryId),t.$set(t.params.transferDetailList[s],"oldPosition",a.data.items[0].positionCode),t.$set(t.params.transferDetailList[s],"price",a.data.items[0].price),t.$set(t.params.transferDetailList[s],"remark",a.data.items[0].remark),r=!1;break}if(r){var n={productName:a.data.items[0].productName,carg:a.data.items[0].carg,productId:a.data.items[0].productId,quantity:a.data.items[0].usableQuantity,inventoryId:a.data.items[0].inventoryId,oldPosition:a.data.items[0].positionCode,price:a.data.items[0].price,remark:a.data.items[0].remark};t.params.transferDetailList.push(n)}e.showToast({title:"扫描添加成功",icon:"none",duration:2e3})}else e.showToast({title:"该产品不存在",icon:"none",duration:2e3});else e.showToast({title:a.message,icon:"none",duration:2e3})}))}})}}};t.default=u}).call(this,a(2)["default"])},734:function(e,t,a){"use strict";a.r(t);var s=a(735),r=a.n(s);for(var n in s)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return s[e]}))}(n);t["default"]=r.a},735:function(e,t,a){}},[[728,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/editTransferStocks/editTransferStocks.js.map