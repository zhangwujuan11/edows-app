(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sales/addFrontendInvoicing"],{888:function(e,t,a){"use strict";(function(e,t){var r=a(4);a(26);r(a(25));var n=r(a(889));e.__webpack_require_UNI_MP_PLUGIN__=a,t(n.default)}).call(this,a(1)["default"],a(2)["createPage"])},889:function(e,t,a){"use strict";a.r(t);var r=a(890),n=a(892);for(var s in n)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(s);a(894);var i,o=a(36),u=Object(o["default"])(n["default"],r["render"],r["staticRenderFns"],!1,null,"a31d411a",null,!1,r["components"],i);u.options.__file="pages/sales/addFrontendInvoicing.vue",t["default"]=u.exports},890:function(e,t,a){"use strict";a.r(t);var r=a(891);a.d(t,"render",(function(){return r["render"]})),a.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),a.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),a.d(t,"components",(function(){return r["components"]}))},891:function(e,t,a){"use strict";var r;a.r(t),a.d(t,"render",(function(){return n})),a.d(t,"staticRenderFns",(function(){return i})),a.d(t,"recyclableRender",(function(){return s})),a.d(t,"components",(function(){return r}));try{r={uniDatetimePicker:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker")]).then(a.bind(null,1136))},uniForms:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(a.bind(null,1116))},uniFormsItem:function(){return Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item")]).then(a.bind(null,1129))},uniPopup:function(){return a.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(a.bind(null,1075))}}}catch(o){if(-1===o.message.indexOf("Cannot find module")||-1===o.message.indexOf(".vue"))throw o;console.error(o.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var n=function(){var e=this,t=e.$createElement,a=(e._self._c,e.params.detailList.length),r=e.__map(e.params.detailList,(function(t,a){var r=e.__get_orig(t),n=e._f("decimalFormat")(e.num(a));return{$orig:r,f0:n}})),n=e.productList&&e.productList.length>0;e.$mp.data=Object.assign({},{$root:{g0:a,l0:r,g1:n}})},s=!1,i=[];n._withStripped=!0},892:function(e,t,a){"use strict";a.r(t);var r=a(893),n=a.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(s);t["default"]=n.a},893:function(e,t,a){"use strict";(function(e){var r=a(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(53)),s=r(a(55)),i=a(57),o=(a(473),function(){a.e("uni_modules/uni-popup/components/uni-popup/uni-popup").then(function(){return resolve(a(1075))}.bind(null,a)).catch(a.oe)}),u=function(){Promise.all([a.e("common/vendor"),a.e("uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker")]).then(function(){return resolve(a(1136))}.bind(null,a)).catch(a.oe)},c={components:{uniPopup:o,uniDatetimePicker:u},data:function(){return{indicatorStyle:"height: 50px;",store:"",inventoryId:"",customer:"",storeName:"",constructionWork:"",priceMode:"",vehicleCategory:"",delivery:"",supplier:"",paymentTerms:"",value:[0],selectList:[],selectList1:[],selectIndex:0,openIndex:null,product:[{},{}],productList:[],searchValue:"",single:"",params:{detailList:[{}]},params1:{pageNum:1,pageSize:20},item:{},index:"",params2:{pageNum:1,pageSize:20},params3:{pageNum:1,pageSize:20},title:"",classification:"",aa:!1,Number:0,rules:{quantity:{rules:[{required:!0,errorMessage:"请输入正确数量"},{pattern:/^[1-9]\d*$/,errorMessage:"请输入大于零的整数"}]},price:{rules:[{required:!0,errorMessage:'请输入单价"'}]}},showMask:!1}},onBackPress:function(e){if("navigateBack"==e.from){var t=getCurrentPages(),a=t[t.length-2];a=a.$vm,a&&a.getList&&(null==a.list?a.getList(1,1):a.getList(1,a.list.length+1))}},filters:{decimalFormat:function(e){return e.toFixed(2)}},computed:{num:function(e){return function(e){return void 0!=this.params.detailList[e].price&&void 0!=this.params.detailList[e].quantity?(this.params.detailList[e].num=this.params.detailList[e].quantity*this.params.detailList[e].price,this.params.detailList[e].totalPrice=this.params.detailList[e].num,this.params.detailList[e].num):this.params.detailList[e].num=0}}},onLoad:function(e){var t=this;return(0,s.default)(n.default.mark((function e(){var a;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,i.getwarehouse)(t.params1);case 2:a=e.sent,a.data.items&&(t.storeName=a.data.items[0].warehouseName,t.params.storeName=t.storeName,t.params.storeId=a.data.items[0].warehouseId,t.params.warehouseId=a.data.items[0].warehouseId);case 4:case"end":return e.stop()}}),e)})))()},methods:{otherFun:function(e){var t=this;return(0,s.default)(n.default.mark((function a(){var r,s,o,u,c;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e){a.next=28;break}return a.next=3,(0,i.detailoutWarehouse)(e);case 3:return r=a.sent,t.params=r.data,t.storeName=r.data.storeName,t.customer=r.data.customer,t.constructionWork=r.data.constructionWork,t.vehicleCategory=r.data.vehicleCategory,t.delivery=r.data.delivery,t.paymentTerms=r.data.paymentTerms,t.priceMode=r.data.priceMode,a.next=14,(0,i.getvehicleCategory)(t.params1);case 14:return s=a.sent,s.data.forEach((function(e){t.vehicleCategory==e.dictValue&&(t.vehicleCategory=e.dictLabel)})),a.next=18,(0,i.getdelivery)(t.params1);case 18:return o=a.sent,o.data.forEach((function(e){t.delivery==e.dictValue&&(t.delivery=e.dictLabel)})),a.next=22,(0,i.getpaymentTerms)(t.params1);case 22:return u=a.sent,u.data.forEach((function(e){t.paymentTerms==e.dictValue&&(t.paymentTerms=e.dictLabel)})),a.next=26,(0,i.getpriceMode)(t.params1);case 26:c=a.sent,c.data.forEach((function(e){t.priceMode==e.dictValue&&(t.priceMode=e.dictLabel)}));case 28:case"end":return a.stop()}}),a)})))()},open:function(t){var a=this;return(0,s.default)(n.default.mark((function r(){var s,o,u,c,d,p,l,m;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a.selectIndex=0,a.selectList=[],a.selectList1=[],r.t0=t,r.next=0===r.t0?6:1===r.t0?12:2===r.t0?18:3===r.t0?24:4===r.t0?30:5===r.t0?36:6===r.t0?42:7===r.t0?48:54;break;case 6:return a.title="请选择业务门店",r.next=9,(0,i.getwarehouse)(a.params1);case 9:return s=r.sent,s.data.items?s.data.items.forEach((function(e){a.selectList.push(e.warehouseName),a.selectList1.push(e.warehouseId)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 12:return a.title="请选择往来客户",r.next=15,(0,i.getcustomer)(a.params1);case 15:return o=r.sent,o.data.items?o.data.items.forEach((function(e){a.selectList.push(e.name),a.selectList1.push(e.customerId)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 18:return a.title="请选择车辆类别",r.next=21,(0,i.getvehicleCategory)(a.params1);case 21:return u=r.sent,u.data?u.data.forEach((function(e){a.selectList.push(e.dictLabel),a.selectList1.push(e.dictValue)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 24:return a.title="请选择接车人员",r.next=27,(0,i.getwen)(a.params1);case 27:return c=r.sent,c.rows?c.rows.forEach((function(e){a.selectList.push(e.userName),a.selectList1.push(e.userId)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 30:return a.title="请选择配方式",r.next=33,(0,i.getdelivery)(a.params1);case 33:return d=r.sent,d.data?d.data.forEach((function(e){a.selectList.push(e.dictLabel),a.selectList1.push(e.dictValue)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 36:return a.title="请选择结算方式",r.next=39,(0,i.getpaymentTerms)(a.params1);case 39:return p=r.sent,p.data?p.data.forEach((function(e){a.selectList.push(e.dictLabel),a.selectList1.push(e.dictValue)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 42:return a.title="请选择价格方式",r.next=45,(0,i.getpriceMode)(a.params1);case 45:return l=r.sent,l.data?l.data.forEach((function(e){a.selectList.push(e.dictLabel),a.selectList1.push(e.dictValue)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 48:return a.title="请选择分类",r.next=51,(0,i.getclassification)(a.params3);case 51:return m=r.sent,m.data?m.data.forEach((function(e){a.selectList.push(e.dictLabel)})):e.showToast({title:"没有数据",icon:"none",duration:1e3}),r.abrupt("break",54);case 54:a.$refs.popup.open(),a.openIndex=t;case 56:case"end":return r.stop()}}),r)})))()},cancel:function(){this.$refs.popup.close()},success:function(){switch(this.openIndex){case 0:this.storeName=this.selectList[this.selectIndex],this.params.storeName!=this.storeName&&this.clear(),this.params.storeName=this.storeName,this.params.storeId=this.selectList1[this.selectIndex],this.params.warehouseId=this.selectList1[this.selectIndex];break;case 1:this.customer=this.selectList[this.selectIndex],this.params.customer=this.customer,this.params.customerId=this.selectList1[this.selectIndex];break;case 2:this.vehicleCategory=this.selectList[this.selectIndex],this.params.vehicleCategory=this.selectList1[this.selectIndex];break;case 3:this.constructionWork=this.selectList[this.selectIndex],this.params.constructionWork=this.constructionWork,this.params.constructionWorkId=this.selectList1[this.selectIndex];break;case 4:this.delivery=this.selectList[this.selectIndex],this.params.delivery=this.selectList1[this.selectIndex];break;case 5:this.paymentTerms=this.selectList[this.selectIndex],this.params.paymentTerms=this.selectList1[this.selectIndex];break;case 6:this.priceMode=this.selectList[this.selectIndex],this.params.priceMode=this.selectList[this.selectIndex];break;case 7:this.classification=this.selectList[this.selectIndex],this.params2.classify=this.classification;break}this.$refs.popup.close()},Addproduct:function(){this.params.detailList.push({}),this.Number++},del:function(e){if(this.params.detailList.length>1){var t=this.params.detailList.filter((function(t,a){return a!==e}));this.params.detailList=t}this.Number>0&&this.Number--},clear:function(){this.params.detailList=[{quantity:"",price:"",remark:"",positionCode:""}]},reset:function(){var e=this;return(0,s.default)(n.default.mark((function t(){var a,r;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.classification="",e.productList=[],a={pageNum:1,pageSize:20},a.warehouseId=e.params2.warehouseId,e.params2={pageNum:1,pageSize:20,warehouseId:a.warehouseId,carg:"",productName:"",pinyin:""},t.next=7,(0,i.getinventory)(a);case 7:r=t.sent,null!=r.data.items&&(e.productList=r.data.items),e.aa=!1;case 10:case"end":return t.stop()}}),t)})))()},scrolltolowerFun:function(){var e=this;return(0,s.default)(n.default.mark((function t(){var a;return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params2.pageNum=e.params2.pageNum+1,t.next=3,(0,i.getinventory)(e.params2);case 3:if(a=t.sent,null==a.data.items){t.next=8;break}a.data.items.forEach((function(t){e.productList.push(t)})),t.next=10;break;case 8:return e.aa=!0,t.abrupt("return");case 10:case"end":return t.stop()}}),t)})))()},search1:function(){var t=this;return(0,s.default)(n.default.mark((function a(){var r;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.productList=[],a.next=3,(0,i.getinventory)(t.params2);case 3:if(r=a.sent,null==r.data.items){a.next=8;break}t.productList=r.data.items,a.next=10;break;case 8:return e.showToast({title:"没有数据",icon:"none",duration:1e3}),a.abrupt("return");case 10:case"end":return a.stop()}}),a)})))()},bindChange:function(e){this.selectIndex=e.detail.value[0]},maskClick:function(e){this.params.enteringTheFactoryDate=e},maskClick1:function(e){this.params.expirationDate=e},add:function(){var t=this;return(0,s.default)(n.default.mark((function a(){var r;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log(new Date(t.params.enteringTheFactoryDate).getTime()),t.params.status=3,t.params.state=0,t.params.orderType=1,t.params.type=2,void 0!=t.params.plateNumber){a.next=9;break}return a.abrupt("return",e.showToast({title:"请输入车牌号",icon:"none",duration:1e3}));case 9:if(void 0!=t.params.customer){a.next=13;break}return a.abrupt("return",e.showToast({title:"请选择往来客户",icon:"none",duration:1e3}));case 13:if(void 0!=t.params.phoneNumber){a.next=17;break}return a.abrupt("return",e.showToast({title:"请输入电话",icon:"none",duration:1e3}));case 17:if(void 0!=t.params.enteringTheFactoryDate){a.next=21;break}return a.abrupt("return",e.showToast({title:"请选择进厂日期",icon:"none",duration:1e3}));case 21:if(void 0!=t.params.expirationDate){a.next=25;break}return a.abrupt("return",e.showToast({title:"请选择到期日期",icon:"none",duration:1e3}));case 25:if(!(new Date(t.params.expirationDate).getTime()<=new Date(t.params.enteringTheFactoryDate).getTime())){a.next=29;break}return a.abrupt("return",e.showToast({title:"到期日期不能在进厂日期前面",icon:"none",duration:1e3}));case 29:if(void 0!=t.params.constructionWork){a.next=33;break}return a.abrupt("return",e.showToast({title:"请选择接车人员",icon:"none",duration:1e3}));case 33:if(void 0!=t.params.delivery){a.next=37;break}return a.abrupt("return",e.showToast({title:"请选择配送方式",icon:"none",duration:1e3}));case 37:if(void 0!=t.params.paymentTerms){a.next=41;break}return a.abrupt("return",e.showToast({title:"请选择结算方式",icon:"none",duration:1e3}));case 41:for(r=0;r<=t.Number;r++)t.$refs.form[r].validate().then(function(){var a=(0,s.default)(n.default.mark((function a(r){var s;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,i.addoutWarehouseForeground)(t.params);case 2:s=a.sent,200==s.code&&(e.showToast({title:"新增成功",icon:"none",duration:1e3}),setTimeout((function(){e.navigateBack({data:1})}),1e3));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 42:case"end":return a.stop()}}),a)})))()},add1:function(){var t=this;return(0,s.default)(n.default.mark((function a(){var r;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.params.status=0,t.params.state=0,t.params.orderType=1,t.params.type=2,void 0!=t.params.plateNumber){a.next=8;break}return a.abrupt("return",e.showToast({title:"请输入车牌号",icon:"none",duration:1e3}));case 8:if(void 0!=t.params.customer){a.next=12;break}return a.abrupt("return",e.showToast({title:"请选择往来客户",icon:"none",duration:1e3}));case 12:if(void 0!=t.params.phoneNumber){a.next=16;break}return a.abrupt("return",e.showToast({title:"请输入电话",icon:"none",duration:1e3}));case 16:if(void 0!=t.params.enteringTheFactoryDate){a.next=20;break}return a.abrupt("return",e.showToast({title:"请选择进厂日期",icon:"none",duration:1e3}));case 20:if(void 0!=t.params.expirationDate){a.next=24;break}return a.abrupt("return",e.showToast({title:"请选择到期日期",icon:"none",duration:1e3}));case 24:if(!(new Date(t.params.expirationDate).getTime()<=new Date(t.params.enteringTheFactoryDate).getTime())){a.next=28;break}return a.abrupt("return",e.showToast({title:"到期日期不能在进厂日期前面",icon:"none",duration:1e3}));case 28:if(void 0!=t.params.constructionWork){a.next=32;break}return a.abrupt("return",e.showToast({title:"请选择接车人员",icon:"none",duration:1e3}));case 32:if(void 0!=t.params.delivery){a.next=36;break}return a.abrupt("return",e.showToast({title:"请选择配送方式",icon:"none",duration:1e3}));case 36:if(void 0!=t.params.paymentTerms){a.next=40;break}return a.abrupt("return",e.showToast({title:"请选择结算方式",icon:"none",duration:1e3}));case 40:for(r=0;r<=t.Number;r++)t.$refs.form[r].validate().then(function(){var a=(0,s.default)(n.default.mark((function a(r){var s;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,(0,i.addoutWarehouseForeground)(t.params);case 2:s=a.sent,200==s.code&&(e.showToast({title:"暂存成功",icon:"none",duration:1e3}),setTimeout((function(){e.navigateBack({data:1})}),1e3));case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}());case 41:case"end":return a.stop()}}),a)})))()},openProduct:function(e){var t=this;return(0,s.default)(n.default.mark((function a(){var r;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.inventoryId="",t.index=e,t.params2.pageNum=1,t.params2.pageSize=20,t.params2.warehouseId=t.params.warehouseId,t.params1.warehouseId=t.params.warehouseId,a.next=8,(0,i.getinventory)(t.params2);case 8:r=a.sent,null!=r.data.items&&(t.productList=r.data.items),t.$refs.product.open();case 11:case"end":return a.stop()}}),a)})))()},closeProduct:function(){this.$refs.product.close()},choice:function(e){this.item=e,this.inventoryId=e.inventoryId},join:function(){if(""==this.inventoryId)return e.showToast({title:"请选择产品",icon:"none",duration:1e3});for(var t=0;t<this.params.detailList.length;t++)if(this.params.detailList[t].inventoryId==this.item.inventoryId)return e.showToast({title:"不能添加相同的产品",icon:"none",duration:1e3});this.$set(this.params.detailList[this.index],"inventoryId",this.item.inventoryId),this.$set(this.params.detailList[this.index],"positionCode",this.item.positionCode),this.$set(this.params.detailList[this.index],"price",this.item.price),this.$set(this.params.detailList[this.index],"productId",this.item.productId),this.$set(this.params.detailList[this.index],"productName",this.item.productName),this.$set(this.params.detailList[this.index],"quantity",this.item.usableQuantity),this.$set(this.params.detailList[this.index],"remark",this.item.remark),this.$refs.product.close()},goChange:function(){e.navigateTo({url:"/pages/sales/conversionFontDesk"})},chioceView:function(){var t=this,a=e.getSystemInfoSync().platform;"android"==a?(plus.android.checkPermission("android.permission.CAMERA",(function(e){-1==e.checkResult&&(t.showMask=!0)}),(function(e){console.error("Error checking permission:",e.message)})),plus.android.requestPermissions(["android.permission.CAMERA"],(function(e){t.showMask=!1,e.granted.length>0&&t.scanCarg()}))):this.scanCarg()},scanCarg:function(){var t=this;e.scanCode({onlyFromCamera:!0,scanType:["barCode"],success:function(a){var r={carg:a.result,pageNum:1,pageSize:1,warehouseId:t.params.warehouseId};(0,i.getinventory)(r).then((function(a){if(200==a.code)if(a.data.items&&a.data.items.length>0){for(var r=0;r<t.params.detailList.length;r++)if(t.params.detailList[r].productId==a.data.items[0].productId)return e.showToast({title:"不能添加相同的产品",icon:"none",duration:1e3});var n=!0;for(r=0;r<t.params.detailList.length;r++)if(!t.params.detailList[r].productName){t.$set(t.params.detailList[r],"productName",a.data.items[0].productName),t.$set(t.params.detailList[r],"productId",a.data.items[0].productId),t.$set(t.params.detailList[r],"quantity",a.data.items[0].usableQuantity),t.$set(t.params.detailList[r],"inventoryId",a.data.items[0].inventoryId),t.$set(t.params.detailList[r],"positionCode",a.data.items[0].positionCode),t.$set(t.params.detailList[r],"price",a.data.items[0].price),t.$set(t.params.detailList[r],"remark",a.data.items[0].remark),n=!1;break}if(n){var s={productName:a.data.items[0].productName,productId:a.data.items[0].productId,quantity:a.data.items[0].usableQuantity,inventoryId:a.data.items[0].inventoryId,positionCode:a.data.items[0].positionCode,price:a.data.items[0].price,remark:a.data.items[0].remark};t.params.detailList.push(s)}e.showToast({title:"扫描添加成功",icon:"none",duration:2e3})}else e.showToast({title:"该产品不存在",icon:"none",duration:2e3});else e.showToast({title:a.message,icon:"none",duration:2e3})}))}})}}};t.default=c}).call(this,a(2)["default"])},894:function(e,t,a){"use strict";a.r(t);var r=a(895),n=a.n(r);for(var s in r)["default"].indexOf(s)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(s);t["default"]=n.a},895:function(e,t,a){}},[[888,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/sales/addFrontendInvoicing.js.map