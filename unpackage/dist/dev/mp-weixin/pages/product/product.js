(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/product"],{100:function(t,e,r){"use strict";(function(t){var n=r(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n(r(53)),a=n(r(55)),s=n(r(11)),i=r(28),u=r(83);function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){(0,s.default)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var l=function(){r.e("components/share").then(function(){return resolve(r(1054))}.bind(null,r)).catch(r.oe)},f=function(){r.e("components/swiperDot").then(function(){return resolve(r(1061))}.bind(null,r)).catch(r.oe)},p=function(){r.e("components/uni-number-box").then(function(){return resolve(r(1068))}.bind(null,r)).catch(r.oe)},h={components:{share:l,swiperDot:f,uniNumberBox:p},data:function(){return{max:99999,isIphoneX:!1,optionType:"",productNum:1,productCode:"",isFixed:!1,productInfo:{},oldProductInfo:{},specClass:"none",seviceClass:"none",specSelected:[],defualtAttrList:[],current:0,favorite:!0,shareList:[],imgList:[],serviceList:[],desc:"",attrList:[],productComments:[],productNavs:["商品详情","商品评价"],currentIndex:0,userStar:[1,2,3,4,5],cartNum:0}},computed:d({},(0,i.mapState)(["hasLogin","userInfo"])),onLoad:function(t){var e=this;return(0,a.default)(o.default.mark((function r(){var n,a;return o.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:void 0!=t.scene?(n=decodeURIComponent(t.scene),a=n.lastIndexOf("="),e.productCode=n.substring(a+1,n.length)):e.productCode=t.code,e.isIphoneX=getApp().globalData.isIphoneX,console.log(e.isIphoneX),console.log(e.productCode),e.getData(),e.getCartNum(),e.getProductComments();case 7:case"end":return r.stop()}}),r)})))()},onShareAppMessage:function(t){return{title:this.productInfo.name,path:"/pages/product/product?code="+this.productCode}},methods:{getData:function(){var t=this;return(0,a.default)(o.default.mark((function e(){var r,n,a,s;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={attrValueDtos:t.defualtAttrList,productCode:t.productCode},e.next=3,t.$axios(t.$baseUrl.getProductByCode,r);case 3:for(a in n=e.sent,t.productInfo=n.data.data,t.desc=n.data.data.detail,t.imgList=n.data.data.subImgList,t.serviceList=n.data.data.serviceList,t.attrList=n.data.data.attrList,t.defualtAttrList=n.data.data.defualtAttrList,t.attrList)if(t.attrList[a].code==t.defualtAttrList[a].attrCode)for(s in t.attrList[a].valueList)t.attrList[a].valueList[s].name==t.defualtAttrList[a].attrValue&&t.$set(t.attrList[a].valueList[s],"selected",!0);case 11:case"end":return e.stop()}}),e)})))()},getCartNum:function(){var t=this;return(0,a.default)(o.default.mark((function e(){var r,n;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={pageNo:1,pageSize:999},e.next=3,t.$axios(t.$baseUrl.getShoppingCartList,r);case 3:n=e.sent,200==n.data.code&&(t.cartNum=n.data.count);case 5:case"end":return e.stop()}}),e)})))()},getProductComments:function(){var t=this;return(0,a.default)(o.default.mark((function e(){var r,n,a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={pageNo:1,pageSize:999,productCode:t.productCode},e.next=3,t.$axios(t.$baseUrl.getProductComments,r);case 3:for(a in n=e.sent,t.productComments=n.data.data,t.productComments)t.productComments[a].createDate=u.fn.formatTime(t.productComments[a].createDate,"Y-M-D");case 6:case"end":return e.stop()}}),e)})))()},cngProNav:function(t){this.currentIndex=t},swiperChange:function(t){this.current=t.detail.current},preview:function(e){var r=e.currentTarget.id;console.log(r),t.previewImage({urls:this.imgList,current:r})},toCart:function(){t.navigateTo({url:"/pages/cart/cart",success:function(t){var e=getCurrentPages().pop();void 0!=e&&null!=e&&e.onLoad()}})},toIndex:function(){t.switchTab({url:"/pages/index/index",success:function(t){var e=getCurrentPages().pop();void 0!=e&&null!=e&&e.onLoad()}})},numberChange:function(t){this.productNum=t.number,this.productNum>this.max&&(this.productNum=this.max),console.log("数量：",this.productNum)},toggleService:function(){var t=this;"show"===this.seviceClass?(this.seviceClass="hide",setTimeout((function(){t.seviceClass="none"}),250)):"none"===this.seviceClass&&(this.seviceClass="show")},toggleSpec:function(t){var e=this;if(this.optionType=t,console.log(t),"show"===this.specClass){this.specClass="hide";var r=0,n=this.defualtAttrList.length;for(var o in this.defualtAttrList)" "!=this.defualtAttrList[o].attrValue&&(r+=1);if(console.log(r,":",n),r!=n)for(var o in this.productInfo=this.oldProductInfo,this.imgList=this.oldProductInfo.subImgList,this.serviceList=this.oldProductInfo.serviceList,this.defualtAttrList=this.oldProductInfo.defualtAttrList,this.attrList=this.oldProductInfo.attrList,this.attrList)if(this.attrList[o].code==this.defualtAttrList[o].attrCode)for(var a in this.attrList[o].valueList)this.attrList[o].valueList[a].name==this.defualtAttrList[o].attrValue&&this.$set(this.attrList[o].valueList[a],"selected",!0);setTimeout((function(){e.specClass="none"}),250)}else"none"===this.specClass&&(this.specClass="show")},toggleSpecSur:function(){var e=this;return(0,a.default)(o.default.mark((function r(){var n,a,s,i,u;return o.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=0;case 1:if(!(n<e.defualtAttrList.length)){r.next=8;break}if(" "!=e.defualtAttrList[n].attrValue){r.next=5;break}return e.$api.msg("请选择"+e.attrList[n].name),r.abrupt("return",!1);case 5:n++,r.next=1;break;case 8:if("cart"!=e.optionType){r.next=14;break}return a={attrValues:e.defualtAttrList,num:e.productNum,productCode:e.productCode},r.next=12,e.$axios(e.$baseUrl.addShoppingCart,JSON.stringify(a));case 12:s=r.sent,200==s.data.code&&(e.getCartNum(),e.$api.msg("加入购物车成功！"));case 14:"buy"==e.optionType&&(i=[],u={productName:e.productInfo.name,price:e.productInfo.price,productCode:e.productInfo.productCode,imgPath:e.productInfo.masterImg,attrValueVOList:e.productInfo.defualtAttrList,isGift:e.productInfo.isGift,giftVOList:e.productInfo.giftVOList,productType:e.productInfo.productType,useSecurityBalance:e.productInfo.useSecurityBalance},i.push({productList:u,productNum:e.productNum}),t.setStorage({key:"tmpOrderData",data:i}),t.navigateTo({url:"/pages/order/createOrder"})),setTimeout((function(){e.specClass="none"}),250);case 16:case"end":return r.stop()}}),r)})))()},selectSpec:function(t,e,r){var n=this;console.log(t,e);var o=this.attrList,a=0,s=this.productInfo.defualtAttrList.length;for(var i in this.productInfo.defualtAttrList)" "!=this.productInfo.defualtAttrList[i].attrValue&&(a+=1);console.log(a,":",s),a==s&&(this.oldProductInfo=this.productInfo);var u=o[t].valueList[e].selected||!1;if(o[t].valueList[e].isShow){for(var i in o[t].valueList)o[t].valueList[i].pCode==r&&this.$set(o[t].valueList[i],"selected",!1);console.log(u),u?this.$set(o[t].valueList[e],"selected",!1):this.$set(o[t].valueList[e],"selected",!0),this.defualtAttrList=[],o.forEach((function(t){for(var e in t.valueList){var r={};!0===t.valueList[e].selected&&(r.attrCode=t.valueList[e].pCode,r.attrValue=t.valueList[e].name,n.defualtAttrList.push(r))}})),console.log(this.defualtAttrList),this.getData()}},share:function(){this.$refs.share.toggleMask()},toFavorite:function(){this.favorite=!this.favorite},buy:function(){t.navigateTo({url:"/pages/order/createOrder"})},stopPrevent:function(){}},filters:{formatRichText:function(t){if(t){var e=t.replace(/<img[^>]*>/gi,(function(t,e){return t=t.replace(/style="[^"]+"/gi,"").replace(/style='[^']+'/gi,""),t=t.replace(/width="[^"]+"/gi,"").replace(/width='[^']+'/gi,""),t=t.replace(/height="[^"]+"/gi,"").replace(/height='[^']+'/gi,""),t}));return e=e.replace(/style="[^"]+"/gi,(function(t,e){return t=t.replace(/width:[^;]+;/gi,"max-width:100%;").replace(/width:[^;]+;/gi,"max-width:100%;"),t})),e=e.replace(/<br[^>]*\/>/gi,""),e=e.replace(/\<img/gi,'<img style="max-width:100%;height:auto;display:flex; flex-direction: column; margin:0 auto ;"'),e}}},onPageScroll:function(t){t.scrollTop>460?this.isFixed=!0:this.isFixed=!1}};e.default=h}).call(this,r(2)["default"])},101:function(t,e,r){"use strict";r.r(e);var n=r(102),o=r.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a},102:function(t,e,r){},95:function(t,e,r){"use strict";(function(t,e){var n=r(4);r(26);n(r(25));var o=n(r(96));t.__webpack_require_UNI_MP_PLUGIN__=r,e(o.default)}).call(this,r(1)["default"],r(2)["createPage"])},96:function(t,e,r){"use strict";r.r(e);var n=r(97),o=r(99);for(var a in o)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return o[t]}))}(a);r(101);var s,i=r(36),u=Object(i["default"])(o["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],s);u.options.__file="pages/product/product.vue",e["default"]=u.exports},97:function(t,e,r){"use strict";r.r(e);var n=r(98);r.d(e,"render",(function(){return n["render"]})),r.d(e,"staticRenderFns",(function(){return n["staticRenderFns"]})),r.d(e,"recyclableRender",(function(){return n["recyclableRender"]})),r.d(e,"components",(function(){return n["components"]}))},98:function(t,e,r){"use strict";var n;r.r(e),r.d(e,"render",(function(){return o})),r.d(e,"staticRenderFns",(function(){return s})),r.d(e,"recyclableRender",(function(){return a})),r.d(e,"components",(function(){return n}));try{n={wmWatermark:function(){return r.e("components/wm-watermark/wm-watermark").then(r.bind(null,1047))}}}catch(i){if(-1===i.message.indexOf("Cannot find module")||-1===i.message.indexOf(".vue"))throw i;console.error(i.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var t=this,e=t.$createElement,r=(t._self._c,0==t.currentIndex?t._f("formatRichText")(t.desc):null),n=1==t.currentIndex?t.__map(t.productComments,(function(e,r){var n=t.__get_orig(e),o=t.productComments.length;return{$orig:n,g0:o}})):null,o=1==t.currentIndex?t.productComments.length:null;t.$mp.data=Object.assign({},{$root:{f0:r,l0:n,g1:o}})},a=!1,s=[];o._withStripped=!0},99:function(t,e,r){"use strict";r.r(e);var n=r(100),o=r.n(n);for(var a in n)["default"].indexOf(a)<0&&function(t){r.d(e,t,(function(){return n[t]}))}(a);e["default"]=o.a}},[[95,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/product/product.js.map